---
layout: post
title:  "并发基础关键字解读"
categories: concurrent
tags:  concurrent
author: Lzg
---

* content
{:toc}

---

# 并发编程的性能挑战

`上下文切换` : 当多个线程运行的时候cpu通过线程调度算法给给每个线程分配时间片，一般是几十ms，当一个线程执行完时间片之后会切换到下一个线程。在切换前会保存当前任务的状态以便下次切回来的时候能继续任务。

`如何避免？` ：
 1. 减少线程数量
 2. 无锁并发编程。多线程竞争锁的时候会引起阻塞，重新恢复的时候会引起上下文切换。
 3. CAS算法更新数据，不需要持有锁。java的`Atomic`包
 4. 协程， 单线程里多任务调度，单线程里多任务切换

`死锁` : 比如说两个线程都持有一把锁，并等待对方释放锁
`避免`：
  1. 避免一个线程获取多个锁
  2. 获取锁顺序保持一致
  3. 尝试使用定时锁， lock.trylock(..)
  4. 避免一个线程在锁内占用过多资源，缩小锁代码路径

`资源限制` ：硬件限制比如说带宽上传下载，磁盘读写等等，软件限制比如说socket连接数和数据库连接数。
`避免`:
  1. 硬件资源问题可以加配置或者搭载集群
  2. 软件资源问题可以用资源池


# 并发基础关键字解读

***volatile***

作用：
